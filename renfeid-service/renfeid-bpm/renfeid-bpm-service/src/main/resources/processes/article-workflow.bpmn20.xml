<?xml version="1.0" encoding="UTF-8"?>
<!--
一个简单的文章审核工作流，用于理解、演示，你可以删除它
同时与它关联的任务实现也可以删除：
src/main/java/net/renfei/bpm/service/PublishArticleService.java
-->
<definitions
        xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:xsd="http://www.w3.org/2001/XMLSchema"
        xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
        xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC"
        xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI"
        xmlns:flowable="http://flowable.org/bpmn"
        typeLanguage="http://www.w3.org/2001/XMLSchema"
        expressionLanguage="http://www.w3.org/1999/XPath"
        targetNamespace="http://www.flowable.org/processdef">
    <process id="articleReview"
             name="一个简单的文章审核工作流" isExecutable="true">

        <startEvent id="start"/>
        <sequenceFlow sourceRef="start" targetRef="reviewArticle"/>
        <!-- 一个审核任务，assignee = renfei -->
        <userTask id="reviewArticle" name="一个审核文章的任务"
                  flowable:assignee="renfei"/>
        <sequenceFlow sourceRef="reviewArticle" targetRef="decision"/>
        <!-- 网关，同意还是拒绝？ -->
        <exclusiveGateway id="decision"/>
        <!-- 同意 -->
        <sequenceFlow sourceRef="decision" targetRef="tutorialApproved">
            <!-- 条件表达式，参数名是 approved -->
            <conditionExpression xsi:type="tFormalExpression">
                <![CDATA[${approved}]]>
            </conditionExpression>
        </sequenceFlow>
        <!-- 拒绝 -->
        <sequenceFlow sourceRef="decision" targetRef="tutorialRejected">
            <!-- 条件表达式，参数名是 approved 并取反 -->
            <conditionExpression xsi:type="tFormalExpression">
                <![CDATA[${!approved}]]>
            </conditionExpression>
        </sequenceFlow>
        <!-- 同意执行的逻辑 -->
        <serviceTask id="tutorialApproved" name="同意执行的逻辑"
                     flowable:class="net.renfei.bpm.service.PublishArticleService"/>
        <sequenceFlow sourceRef="tutorialApproved" targetRef="end"/>
        <!-- 拒绝执行的逻辑 -->
        <serviceTask id="tutorialRejected" name="拒绝执行的逻辑"
                     flowable:class="com.baeldung.service.SendMailService"/>
        <sequenceFlow sourceRef="tutorialRejected" targetRef="end"/>

        <endEvent id="end"/>
    </process>
</definitions>